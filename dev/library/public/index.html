<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Public ¬∑ ParameterEstimocean.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://clima.github.io/ParameterEstimocean/dev/library/public/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ParameterEstimocean.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation_instructions/">Installation Instructions</a></li><li><a class="tocitem" href="../../literated/intro_to_observations/">Intro to observations</a></li><li><a class="tocitem" href="../../literated/intro_to_inverse_problems/">Intro to inverse problems</a></li><li><a class="tocitem" href="../../literated/exploring_priors/">Exploring Prior distributions</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../literated/perfect_convective_adjustment_calibration/">Perfect convective adjustment calibration with Ensemble Kalman Inversion</a></li><li><a class="tocitem" href="../../literated/single_case_lesbrary_ri_based_calibration/">Calibration of <code>RiBasedVerticalDiffusivity</code> to one LESbrary simulation</a></li><li><a class="tocitem" href="../../literated/multi_case_lesbrary_ri_based_calibration/">Calibration of <code>RiBasedVerticalDiffusivity</code> to five LESbrary simulations</a></li><li><a class="tocitem" href="../../literated/perfect_baroclinic_adjustment_calibration/">Perfect baroclinic adjustment calibration with Ensemble Kalman Inversion</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../outline/">Contents</a></li><li class="is-active"><a class="tocitem" href>Public</a><ul class="internal"><li><a class="tocitem" href="#ParameterEstimocean"><span>ParameterEstimocean</span></a></li><li><a class="tocitem" href="#Transformations"><span>Transformations</span></a></li><li><a class="tocitem" href="#Observations"><span>Observations</span></a></li><li><a class="tocitem" href="#Ensemble-Simulations"><span>Ensemble Simulations</span></a></li><li><a class="tocitem" href="#Parameters"><span>Parameters</span></a></li><li><a class="tocitem" href="#Inverse-Problems"><span>Inverse Problems</span></a></li><li><a class="tocitem" href="#EnsembleKalmanInversions"><span>EnsembleKalmanInversions</span></a></li></ul></li><li><a class="tocitem" href="../internals/">Private</a></li><li><a class="tocitem" href="../function_index/">Function index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Library</a></li><li class="is-active"><a href>Public</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Public</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/main/docs/src/library/public.md" title="Edit on GitHub"><span class="docs-icon fab">ÔÇõ</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Public-Documentation"><a class="docs-heading-anchor" href="#Public-Documentation">Public Documentation</a><a id="Public-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Public-Documentation" title="Permalink"></a></h1><p>Documentation for <code>ParameterEstimocean.jl</code>&#39;s public interface.</p><p>See the Internals section of the manual for internal package docs covering all submodules.</p><h2 id="ParameterEstimocean"><a class="docs-heading-anchor" href="#ParameterEstimocean">ParameterEstimocean</a><a id="ParameterEstimocean-1"></a><a class="docs-heading-anchor-permalink" href="#ParameterEstimocean" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.ParameterEstimocean" href="#ParameterEstimocean.ParameterEstimocean"><code>ParameterEstimocean.ParameterEstimocean</code></a> ‚Äî <span class="docstring-category">Module</span></header><section><div><p>Main module for <code>ParameterEstimocean.jl</code> ‚Äì a Julia software for parameter estimation for Oceananigans models using Ensemble Kalman Inversion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/ParameterEstimocean.jl#L1-L4">source</a></section></article><h2 id="Transformations"><a class="docs-heading-anchor" href="#Transformations">Transformations</a><a id="Transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Transformations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.Transformations.Transformation-Tuple{}" href="#ParameterEstimocean.Transformations.Transformation-Tuple{}"><code>ParameterEstimocean.Transformations.Transformation</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Transformation(; time=nothing, space=nothing, normalization=nothing)</code></pre><p>Return a transformation that is applied on the observation. Examples include slicing the data or multiplying with weight factors to make the loss function putting more  weight in particular regions of the domain or particular times. Also, we can denote a normalization procedure applied to the data <em>after</em> the space- and time- transformations.</p><p>Slicing is prescribed as <code>SpaceIndices</code> and <code>TimeIndices</code>. For example,</p><pre><code class="language-julia hljs">Transformation(time = TimeIndices(4:10))</code></pre><p>only keeps time instances 4 to 10 from the observations. Similarly,</p><pre><code class="language-julia hljs">Transformation(space = SpaceIndices(x=:, y=1:10, z=2:2:20))</code></pre><p>does not affect the <code>x</code> dimension of the data, but slices the observations in <code>y</code> and <code>z</code> as prescribed.</p><p><strong>Keyword Arguments</strong></p><ul><li><p><code>time</code>: The time transformation either as a <code>TimeIndices</code> or as an <code>AbstractVector</code> of weights of same size as <code>observations.times</code>. If <code>nothing</code> is given, then, by default, the transformation ignores the first snapshot (initial state). (Default: <code>nothing</code>)</p></li><li><p><code>space</code>: The space trasformation either as a <code>SpaceIndices</code> or as an <code>AbstractArray</code> of weights of same size as a snapshot of the observations. (Default: <code>nothing</code>)</p></li><li><p><code>normalization</code>: The normalization that is applied to the data after space and time  transformations have been applied first. (Default: <code>nothing</code>)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/Transformations.jl#L20-L56">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.Transformations.ZScore-Tuple{Any}" href="#ParameterEstimocean.Transformations.ZScore-Tuple{Any}"><code>ParameterEstimocean.Transformations.ZScore</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ZScore(data)</code></pre><p>Return the <code>ZScore</code> normalization of a <code>FieldTimeSeries</code> after computing its mean and its variance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/Transformations.jl#L172-L177">source</a></section></article><h2 id="Observations"><a class="docs-heading-anchor" href="#Observations">Observations</a><a id="Observations-1"></a><a class="docs-heading-anchor-permalink" href="#Observations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.Observations.SyntheticObservations" href="#ParameterEstimocean.Observations.SyntheticObservations"><code>ParameterEstimocean.Observations.SyntheticObservations</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SyntheticObservations(path=nothing;
                      field_names,
                      forward_map_names = field_names,
                      transformation = Transformation(),
                      times = nothing,
                      field_time_serieses = nothing,
                      architecture = CPU(),
                      regrid = nothing)</code></pre><p>Return a time series of synthetic observations generated by Oceananigans.jl&#39;s simulations gridded as Oceananigans.jl fields.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/Observations.jl#L36-L48">source</a></section></article><h2 id="Ensemble-Simulations"><a class="docs-heading-anchor" href="#Ensemble-Simulations">Ensemble Simulations</a><a id="Ensemble-Simulations-1"></a><a class="docs-heading-anchor-permalink" href="#Ensemble-Simulations" title="Permalink"></a></h2><h2 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.Parameters.FreeParameters" href="#ParameterEstimocean.Parameters.FreeParameters"><code>ParameterEstimocean.Parameters.FreeParameters</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct FreeParameters{N, P, D}</code></pre><p>A container for free parameters that includes the parameter names and their corresponding prior distributions.</p><ul><li><p><code>names</code></p><p>free parameters</p></li><li><p><code>priors</code></p><p>prior distributions for free parameters</p></li><li><p><code>dependent_parameters</code></p><p>dependent parameters</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/Parameters.jl#L259-L266">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.Parameters.FreeParameters-Tuple{Any}" href="#ParameterEstimocean.Parameters.FreeParameters-Tuple{Any}"><code>ParameterEstimocean.Parameters.FreeParameters</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">FreeParameters(priors; names = Symbol.(keys(priors)), dependent_parameters=NamedTuple())</code></pre><p>Return named <code>FreeParameters</code> with priors. Free parameter <code>names</code> are inferred from the keys of <code>priors</code> if not provided. Optionally, <code>dependent_parameters</code> are prescribed as a <code>NamedTuple</code> whose keys are the names of &quot;additional&quot; parameters, and whose values are functions that return those parameters given a vector of free parameters in <code>names</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Distributions, ParameterEstimocean

julia&gt; priors = (ŒΩ = Normal(1e-4, 1e-5), Œ∫ = Normal(1e-3, 1e-5))
(ŒΩ = Normal{Float64}(Œº=0.0001, œÉ=1.0e-5), Œ∫ = Normal{Float64}(Œº=0.001, œÉ=1.0e-5))

julia&gt; free_parameters = FreeParameters(priors)
FreeParameters with 2 parameters
‚îú‚îÄ‚îÄ names: (:ŒΩ, :Œ∫)
‚îú‚îÄ‚îÄ priors: Dict{Symbol, Any}
‚îÇ   ‚îú‚îÄ‚îÄ ŒΩ =&gt; Normal{Float64}(Œº=0.0001, œÉ=1.0e-5)
‚îÇ   ‚îî‚îÄ‚îÄ Œ∫ =&gt; Normal{Float64}(Œº=0.001, œÉ=1.0e-5)
‚îî‚îÄ‚îÄ dependent parameters: Dict{Symbol, Any}

julia&gt; c(p) = p.ŒΩ + p.Œ∫ # compute a third dependent parameter `c` as a function of `ŒΩ` and `Œ∫`
c (generic function with 1 method)

julia&gt; free_parameters_with_a_dependent = FreeParameters(priors, dependent_parameters=(; c))
FreeParameters with 2 parameters and 1 dependent parameter
‚îú‚îÄ‚îÄ names: (:ŒΩ, :Œ∫)
‚îú‚îÄ‚îÄ priors: Dict{Symbol, Any}
‚îÇ   ‚îú‚îÄ‚îÄ ŒΩ =&gt; Normal{Float64}(Œº=0.0001, œÉ=1.0e-5)
‚îÇ   ‚îî‚îÄ‚îÄ Œ∫ =&gt; Normal{Float64}(Œº=0.001, œÉ=1.0e-5)
‚îî‚îÄ‚îÄ dependent parameters: Dict{Symbol, Any}
    ‚îî‚îÄ‚îÄ c =&gt; c (generic function with 1 method)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/Parameters.jl#L276-L313">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.Parameters.ScaledLogitNormal" href="#ParameterEstimocean.Parameters.ScaledLogitNormal"><code>ParameterEstimocean.Parameters.ScaledLogitNormal</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ScaledLogitNormal([FT=Float64;] bounds=(0, 1), mass=0.5, interval=nothing, Œº=nothing, œÉ=nothing)</code></pre><p>Return a <code>ScaledLogitNormal</code> distribution with compact support within <code>bounds</code>.</p><p><code>interval</code> is an optional 2-element tuple or Array. When specified, the parameters <code>Œº</code> and <code>œÉ</code> of the underlying <code>Normal</code> distribution are calculated so that <code>mass</code> fraction of the probability density lies within <code>interval</code>.</p><p>If <code>interval</code> is not specified, then <code>Œº=0</code> and <code>œÉ=1</code> by default.</p><p><strong>Notes</strong></p><p><code>ScaledLogitNormal</code> is a four-parameter distribution generated by the transformation</p><p class="math-container">\[Y = L + (U - L) / [1 + \exp(X)],\]</p><p>of the normally-distributed variate <span>$X ‚àº ùí©(Œº, œÉ)$</span>. The four parameters governing the distribution of <span>$Y$</span> are thus</p><ul><li><span>$L$</span>:  lower bound (0 for the <code>LogitNormal</code> distribution)</li><li><span>$U$</span>:  upper bound (1 for the <code>LogitNormal</code> distribution)</li><li><span>$Œº$</span>:  mean of the underlying <code>Normal</code> distribution</li><li><span>$œÉ¬≤$</span>: variance of the underlying <code>Normal</code> distribution</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/Parameters.jl#L101-L130">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.Parameters.lognormal-Tuple{}" href="#ParameterEstimocean.Parameters.lognormal-Tuple{}"><code>ParameterEstimocean.Parameters.lognormal</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">lognormal(; mean, std)</code></pre><p>Return <code>Lognormal</code> distribution parameterized by  the distribution <code>mean</code> and standard deviation <code>std</code>.</p><p><strong>Notes</strong></p><p>A variate <code>X</code> is <code>LogNormal</code> distributed if</p><p class="math-container">\[\log(X) ‚àº ùí©(Œº, œÉ¬≤) ,\]</p><p>where <span>$ùí©(Œº, œÉ¬≤)$</span> is the <code>Normal</code> distribution with mean <span>$Œº$</span> and variance <span>$œÉ¬≤$</span>.</p><p>The <code>mean</code> and variance <span>$s¬≤$</span> (where <span>$s$</span> is the standard deviation or <code>std</code>) are related to the parameters <span>$Œº$</span> and <span>$œÉ¬≤$</span> via</p><p class="math-container">\[ m = \exp(Œº + œÉ¬≤ / 2),\]</p><p class="math-container">\[s¬≤ = [\exp(œÉ¬≤) - 1] m¬≤.\]</p><p>These formula allow us to calculate <span>$Œº$</span> and <span>$œÉ$</span> given <span>$m$</span> and <span>$s¬≤$</span>, since rearranging the formula for <span>$s¬≤$</span> gives</p><p class="math-container">\[\exp(œÉ¬≤) = m¬≤ / s¬≤ + 1\]</p><p>which then yields</p><p class="math-container">\[œÉ = \sqrt{\log(m¬≤ / s¬≤ + 1)}.\]</p><p>We then find that</p><p class="math-container">\[Œº = \log(m) - œÉ¬≤ / 2 .\]</p><p>See also <a href="https://en.wikipedia.org/wiki/Log-normal_distribution#Generation_and_parameters">wikipedia</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/Parameters.jl#L22-L73">source</a></section></article><h2 id="Inverse-Problems"><a class="docs-heading-anchor" href="#Inverse-Problems">Inverse Problems</a><a id="Inverse-Problems-1"></a><a class="docs-heading-anchor-permalink" href="#Inverse-Problems" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.InverseProblems.ConcatenatedOutputMap" href="#ParameterEstimocean.InverseProblems.ConcatenatedOutputMap"><code>ParameterEstimocean.InverseProblems.ConcatenatedOutputMap</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct ConcatenatedOutputMap</code></pre><p>Forward map transformation of simulation output to the concatenated vectors of the simulation output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/InverseProblems.jl#L45-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.InverseProblems.InverseProblem-Tuple{Any, Any, Any}" href="#ParameterEstimocean.InverseProblems.InverseProblem-Tuple{Any, Any, Any}"><code>ParameterEstimocean.InverseProblems.InverseProblem</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">InverseProblem(observations,
               simulation,
               free_parameters;
               output_map = ConcatenatedOutputMap(),
               time_series_collector = nothing,
               initialize_simulation = nothingfunction)</code></pre><p>Return an <code>InverseProblem</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/InverseProblems.jl#L70-L79">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.InverseProblems.forward_map-Tuple{Any, Any}" href="#ParameterEstimocean.InverseProblems.forward_map-Tuple{Any, Any}"><code>ParameterEstimocean.InverseProblems.forward_map</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">forward_map(ip, parameters)</code></pre><p>Run <code>ip.simulation</code> forward with <code>parameters</code> and return the data, transformed into an array format expected by <code>EnsembleKalmanProcesses.jl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/InverseProblems.jl#L197-L202">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.InverseProblems.forward_run!-Tuple{InverseProblem, Any}" href="#ParameterEstimocean.InverseProblems.forward_run!-Tuple{InverseProblem, Any}"><code>ParameterEstimocean.InverseProblems.forward_run!</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">forward_run!(ip, parameters)</code></pre><p>Initialize <code>ip.simulation</code> with <code>parameters</code> and run it forward. Output is stored in <code>ip.time_series_collector</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/InverseProblems.jl#L169-L174">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.InverseProblems.observation_map-Tuple{InverseProblem}" href="#ParameterEstimocean.InverseProblems.observation_map-Tuple{InverseProblem}"><code>ParameterEstimocean.InverseProblems.observation_map</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">observation_map(ip::InverseProblem)</code></pre><p>Transform and return <code>ip.observations</code> appropriate for <code>ip.output_map</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/InverseProblems.jl#L160-L164">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.InverseProblems.observation_map_variance_across_time-Tuple{ConcatenatedOutputMap, SyntheticObservations}" href="#ParameterEstimocean.InverseProblems.observation_map_variance_across_time-Tuple{ConcatenatedOutputMap, SyntheticObservations}"><code>ParameterEstimocean.InverseProblems.observation_map_variance_across_time</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">observation_map_variance_across_time(map::ConcatenatedOutputMap, observation::SyntheticObservations)</code></pre><p>Return an array of size <code>(Nensemble, Ny * Nz * Nfields, Ny * Nz * Nfields)</code> that stores the covariance of each element of the observation map measured across time, for each ensemble member, where <code>Nensemble</code> is the ensemble size, <code>Ny</code> is either the number of grid elements in <code>y</code> or the batch size, <code>Nz</code> is the number of grid elements in the vertical, and <code>Nfields</code> is the number of fields in <code>observation</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/InverseProblems.jl#L401-L408">source</a></section></article><h2 id="EnsembleKalmanInversions"><a class="docs-heading-anchor" href="#EnsembleKalmanInversions">EnsembleKalmanInversions</a><a id="EnsembleKalmanInversions-1"></a><a class="docs-heading-anchor-permalink" href="#EnsembleKalmanInversions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.EnsembleKalmanInversions.EnsembleKalmanInversion-Tuple{Any}" href="#ParameterEstimocean.EnsembleKalmanInversions.EnsembleKalmanInversion-Tuple{Any}"><code>ParameterEstimocean.EnsembleKalmanInversions.EnsembleKalmanInversion</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">EnsembleKalmanInversion(inverse_problem;
                        noise_covariance = 1,
                        pseudo_stepping = nothing,
                        resampler = Resampler(),
                        unconstrained_parameters = nothing,
                        forward_map_output = nothing,
                        mark_failed_particles = NormExceedsMedian(1e9),
                        ensemble_kalman_process = Inversion())</code></pre><p>Return an object that finds local minima of the inverse problem:</p><p class="math-container">\[y = G(Œ∏) + Œ∑,\]</p><p>for the parameters <span>$Œ∏$</span>, where <span>$y$</span> is a vector of observations (often normalized), <span>$G(Œ∏)$</span> is a forward map that predicts the observations, and <span>$Œ∑ ‚àº ùí©(0, Œì_y)$</span> is zero-mean random noise with a <code>noise_covariance</code> matrix <span>$Œì_y$</span> representing uncertainty in the observations.</p><p>The &quot;forward map output&quot; <code>G</code> is model output mapped to the space of <code>inverse_problem.observations</code>.</p><p>(For more details on the Ensemble Kalman Inversion algorithm refer to the <a href="https://clima.github.io/EnsembleKalmanProcesses.jl/stable/ensemble_kalman_inversion/">EnsembleKalmanProcesses.jl Documentation</a>.)</p><p><strong>Positional Arguments</strong></p><ul><li><code>inverse_problem</code> (<code>InverseProblem</code>): Represents an inverse problem representing the comparison between                                       synthetic observations generated by                                       <a href="https://clima.github.io/OceananigansDocumentation/stable/">Oceananigans.jl</a>                                       and model predictions, also generated by Oceananigans.jl.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>noise_covariance</code> (<code>Number</code> or <code>AbstractMatrix</code>): Covariance matrix representing observational uncertainty.                                                    <code>noise_covariance::Number</code> is converted to a scaled identity matrix.</p></li><li><p><code>pseudo_stepping</code>: The pseudo time-stepping scheme for stepping EKI forward.</p></li><li><p><code>resampler</code>: controls particle resampling procedure. See <code>Resampler</code>.</p></li><li><p><code>unconstrained_parameters</code>: Default: <code>nothing</code>.</p></li><li><p><code>forward_map_output</code>: Default: <code>nothing</code>.</p></li><li><p><code>ensemble_kalman_process</code>: Process type defined by <code>EnsembleKalmanProcesses.jl</code>.                            Default: <code>Inversion()</code>.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/EnsembleKalmanInversions.jl#L68-L116">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.EnsembleKalmanInversions.NormExceedsMedian" href="#ParameterEstimocean.EnsembleKalmanInversions.NormExceedsMedian"><code>ParameterEstimocean.EnsembleKalmanInversions.NormExceedsMedian</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">NormExceedsMedian(minimum_relative_norm = 1e9)</code></pre><p>The particle failure condition. A particle is marked &quot;failed&quot; if the forward map norm is larger than <code>minimum_relative_norm</code> times more than the median value of the ensemble. By default <code>minimum_relative_norm = 1e9</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/EnsembleKalmanInversions.jl#L272-L278">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.EnsembleKalmanInversions.NormExceedsMedian-Tuple{Any}" href="#ParameterEstimocean.EnsembleKalmanInversions.NormExceedsMedian-Tuple{Any}"><code>ParameterEstimocean.EnsembleKalmanInversions.NormExceedsMedian</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Return a BitVector indicating whether the norm of the forward map for a given particle exceeds the median by <code>mrn.minimum_relative_norm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/EnsembleKalmanInversions.jl#L286-L288">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ParameterEstimocean.EnsembleKalmanInversions.iterate!-Tuple{EnsembleKalmanInversion}" href="#ParameterEstimocean.EnsembleKalmanInversions.iterate!-Tuple{EnsembleKalmanInversion}"><code>ParameterEstimocean.EnsembleKalmanInversions.iterate!</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">iterate!(eki::EnsembleKalmanInversion;
         iterations = 1,
         pseudo_Œît = eki.pseudo_Œît,
         pseudo_stepping = eki.pseudo_stepping,
         show_progress = true)</code></pre><p>Iterate the ensemble Kalman inversion problem <code>eki</code> forward by <code>iterations</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><p><code>iterations</code> (<code>Int</code>): Number of iterations to run. (Default: 1)</p></li><li><p><code>pseudo_Œît</code> (<code>Float64</code>): Pseudo time-step. When <code>convegence_rate</code> is specified,                          this is an initial guess for finding an adaptive time-step.                          (Default: <code>eki.pseudo_Œît</code>)</p></li><li><p><code>pseudo_stepping</code> (<code>Float64</code>): Ensemble convergence rate for adaptive time-stepping.                                (Default: <code>eki.pseudo_stepping</code>)</p></li><li><p><code>show_progress</code> (<code>Boolean</code>): Whether to show a progress bar. (Default: <code>true</code>)</p></li></ul><p><strong>Return</strong></p><ul><li><code>best_parameters</code>: the ensemble mean of all parameter values after the last iteration.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ParameterEstimocean.jl/blob/c5c32fafa2359b9eb875dc6cd2cc989048f850cc/src/EnsembleKalmanInversions.jl#L210-L237">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../outline/">¬´ Contents</a><a class="docs-footer-nextpage" href="../internals/">Private ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Saturday 11 June 2022 01:24">Saturday 11 June 2022</span>. Using Julia version 1.6.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
